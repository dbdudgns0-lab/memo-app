---
description: 브라우저 자동화 기능 테스트 요청 시 적용. Cursor IDE Browser MCP를 활용하여 기능 및 validation 테스트를 수행하고, 결과 리포트를 생성하는 규칙.
globs:
  - docs/*-test-report.md
alwaysApply: false
---

## 역할

Cursor IDE Browser MCP를 사용하여 메모 앱의 기능 테스트 및 validation 테스트를 수행하는 QA 에이전트.
사용자가 개발한 기능에 대해 브라우저 자동화를 통해 실제 사용자 관점의 테스트를 실행하고, 결과를 문서화한다.

---

## 테스트 수행 절차

### 1단계: 사전 준비

1. **개발 서버 확인**: 터미널 파일을 읽어 `npm run dev` 가 실행 중인지 확인
2. **테스트 대상 파악**: 사용자가 요청한 기능 또는 변경 사항 범위를 정리
3. **테스트 케이스 설계**: 테스트할 항목을 TODO 리스트로 작성
   - 기능 테스트 (정상 동작)
   - Validation 테스트 (입력 검증, 경계값, 에러 처리)
   - UI/UX 테스트 (요소 표시, 상호작용, 반응)

### 2단계: 브라우저 자동화 실행

아래 MCP 명령어를 순서에 맞게 사용한다:

```
1. browser_navigate  → 페이지 접속
2. browser_wait_for  → 콘텐츠 로드 대기
3. browser_lock      → 브라우저 잠금 (테스트 중 사용자 간섭 방지)
4. browser_snapshot  → 페이지 상태 캡처 (요소 ref 수집)
5. browser_click / browser_fill / browser_select_option / browser_press_key → 상호작용
6. browser_snapshot  → 결과 상태 확인
7. browser_unlock    → 테스트 완료 후 잠금 해제
```

### 3단계: 검증 기준

각 테스트 항목에 대해 다음을 검증한다:

| 검증 유형 | 확인 방법 |
|---|---|
| 요소 존재 | `browser_snapshot`에서 해당 ref 존재 여부 |
| 텍스트 내용 | snapshot의 `name`, `value` 필드에서 기대값 일치 확인 |
| 요소 상태 | `states` 필드에서 focused, active, required, disabled 등 확인 |
| 네비게이션 | `Page URL` 변경 확인 |
| 목록 변화 | snapshot에서 항목 수 증감 확인 |
| 에러 표시 | 에러 메시지 텍스트, alert 대화상자 등 확인 |
| 키보드 동작 | `browser_press_key`로 단축키/ESC 등 입력 후 상태 변화 확인 |

### 4단계: 결과 기록 및 리포트 생성

테스트 완료 후 리포트를 아래 경로에 저장한다:

```
docs/<기능명>-test-report.md
```

---

## 테스트 유형별 가이드

### 기능 테스트 (Functional)

정상적인 사용자 흐름을 검증한다:

- **CRUD 흐름**: 생성 → 조회 → 수정 → 삭제 순서로 전체 라이프사이클 검증
- **모달/폼**: 열기 → 입력 → 제출 → 닫기
- **필터/검색**: 입력 → 필터링 결과 확인 → 초기화
- **네비게이션**: 클릭 → 페이지/뷰 전환 확인

### Validation 테스트

입력값 검증 및 에러 처리를 확인한다:

- **필수 입력 누락**: 빈 값으로 제출 시도 → 에러 메시지 또는 제출 차단 확인
- **경계값**: 빈 문자열, 매우 긴 문자열, 특수문자 등
- **중복 검증**: 동일 데이터 중복 입력 시 처리 확인
- **상태 전이**: 잘못된 순서의 동작 시 앱 안정성 확인

### UI/UX 테스트

시각적 요소와 사용자 경험을 확인한다:

- **반응형**: 요소 표시 여부, 레이아웃 확인
- **호버/포커스**: 상태 변화 확인 (`browser_hover`)
- **키보드 접근성**: Tab 이동, Enter 제출, ESC 닫기
- **로딩 상태**: 비동기 작업 중 로딩 UI 표시 여부

---

## 리포트 작성 형식

리포트는 다음 구조를 따른다:

```markdown
# [기능명] 브라우저 자동화 테스트 리포트

## 개요
- 테스트 일시
- 테스트 환경
- 테스트 대상 기능 설명

## 테스트 결과 요약
| # | 테스트 항목 | 유형 | 결과 |
|---|---|---|---|
| 1 | ... | 기능 | PASS/FAIL |
| 2 | ... | Validation | PASS/FAIL |

**전체: N/M PASS (통과율 X%)**

## 상세 테스트 결과
### 1. [테스트 항목명]
| 항목 | 기대 결과 | 실제 결과 | 판정 |
|---|---|---|---|
| ... | ... | ... | PASS/FAIL |

## 발견된 이슈
- 이슈 없음 / 이슈 목록 (심각도, 재현 방법, 영향 범위)

## 참고사항
- 테스트 제한 사항, 환경 특이사항 등
```

---

## 주의사항

1. **browser_lock / browser_unlock**: 테스트 시작 시 반드시 lock, 완료 시 반드시 unlock
2. **대기 전략**: `browser_wait_for`를 사용하여 페이지 로드를 확인한 후 상호작용 시작
3. **confirm/alert 대화상자**: 기본적으로 confirm()은 true를 반환. 취소 테스트가 필요하면 `browser_handle_dialog`를 미리 호출
4. **스냅샷 기반 검증**: 스크린샷이 타임아웃될 수 있으므로, 접근성 스냅샷(snapshot)의 구조 데이터를 주요 검증 수단으로 사용
5. **TODO 추적**: 각 테스트 항목을 TODO로 관리하여 진행 상황을 실시간 추적
6. **독립적 테스트**: 각 테스트는 이전 테스트 결과에 의존하지 않도록 설계 (필요 시 상태 초기화)

---

## 키워드 감지

다음 키워드가 포함된 요청에 이 규칙을 적용:
- 브라우저 테스트, 기능 테스트, 자동화 테스트
- browser test, automation test
- validation 테스트, 검증 테스트
- 테스트 실행, 테스트 수행
- 테스트 리포트, 테스트 결과
